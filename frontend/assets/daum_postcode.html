<!doctype html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
    <title>주소 검색</title>
    <script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <style>html,body,#wrap{height:100%;margin:0;padding:0;background:#fff;}</style>
</head>
<body>
<div id="wrap"></div>
<script>
    function sendToFlutter(payload){
      var json = JSON.stringify(payload);
      try {
        if (window.ToFlutter && typeof ToFlutter.postMessage === 'function') {
          ToFlutter.postMessage(json);  // 정상 경로
          return;
        }
      } catch (e) {}
      // 백업 경로: 네비게이션
      location.href = 'app://addr?data=' + encodeURIComponent(json);
    }

    new daum.Postcode({
      oncomplete: function(data) {
        sendToFlutter({
          zonecode: data.zonecode,
          address: data.address,
          roadAddress: data.roadAddress,
          jibunAddress: data.jibunAddress,
          buildingName: data.buildingName,
          sido: data.sido,
          sigungu: data.sigungu
        });
      }
    }).embed(document.getElementById('wrap'));
</script>
</body>
</html>
